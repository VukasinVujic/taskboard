@if (toastVm$ | async; as vm) { @if(vm.visible){
<div
  class="toast"
  [class.success]="vm.type === 'success'"
  [class.error]="vm.type === 'error'"
  [class.info]="vm.type === 'info'"
>
  {{ vm.message }}

  @if( vm.countdown !== null){
  <span>
    {{ vm.countdown }}
  </span>

  }
  <button (click)="closeToast()">X</button>
</div>

} }
<div style="margin-top: 20px">Search tasks:</div>

@if(pageVm$ | async; as pageVm){

<input
  type="text"
  (input)="onSearch($event.target.value)"
  [value]="pageVm.taskList?.rawTerm"
/>
<select
  name=""
  id=""
  [value]="pageVm.taskList?.taskStatus"
  (change)="onStatusFilterChange($any($event.target).value)"
>
  <option value="all">All</option>
  <option value="todo">Todo</option>
  <option value="in-progress">In Progress</option>
  <option value="done">Done</option>
</select>

@if(pageVm.taskList.loading){
<div>Loading...</div>
} @if(pageVm.taskList.showNoTasksYet) {
<div class="no-tasks">No task still added ... please add new task</div>

} @if(pageVm.taskList.showNoResults){
<div class="no-tasks">
  No results for : "<strong> {{ pageVm.taskList.trimTerm }} </strong>"
</div>

@if(pageVm.taskList.trimTerm.length > 0){
<button class="no-tasks-btn" (click)="clearSearch()">Clear search</button>

} } @if(pageVm.taskList.showNoResults){ No tasks in status :

{{ pageVm.taskList.taskStatus }}

<button class="no-tasks-btn" (click)="resetFilter()">Reset Filter</button>

}

<div class="kanaban">
  <app-task-column
    title="TODO"
    [tasks]="pageVm.kanban.todo"
    [statuses]="statuses"
    [updatingTaskIds]="pageVm.updatingTaskIds"
    (changeStatus)="onChangeStatus($event.id, $event.status)"
    (deleteTask)="deleteTask($event)"
    (saveTask)="onUpdateTask($event)"
  />

  <app-task-column
    title="IN PROGRESS"
    [tasks]="pageVm.kanban.inProgress"
    [statuses]="statuses"
    [updatingTaskIds]="pageVm.updatingTaskIds"
    (changeStatus)="onChangeStatus($event.id, $event.status)"
    (deleteTask)="deleteTask($event)"
    (saveTask)="onUpdateTask($event)"
  />

  <app-task-column
    title="DONE"
    [tasks]="pageVm.kanban.done"
    [statuses]="statuses"
    [updatingTaskIds]="pageVm.updatingTaskIds"
    (changeStatus)="onChangeStatus($event.id, $event.status)"
    (deleteTask)="deleteTask($event)"
    (saveTask)="onUpdateTask($event)"
  />
</div>

@if(pageVm.undo.visible){
<button (click)="unDoDeletedTask()" class="undo-bar">
  {{ pageVm.undo.text }}
</button>

<div>Undo za {{ pageVm.undo.countdown }}</div>
} }
